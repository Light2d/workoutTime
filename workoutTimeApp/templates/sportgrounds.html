

{% load static %}
{% include "base.html" %}
{% include "header.html" %}

<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

    <main>
        <div class="chapter">
            <div class="chapter__container container">
                <div class="chapter__logo">
                    <img src="{% static 'imgs/intro/textLogo.png' %}" alt="">
                </div>
                <div class="chapter__title">Площадки</div>
            </div>
        </div>
       <div class="sportgroundMap">
        <div class="map__container container">
            <div class="sportgroundMap__map" id="map">

            </div>
          </div>
       </div>
       <div class="sportground">
        <div class="container sportground__container">
            <div class="sportground__items">
                <div class="sportground__item">
                    <div class="sportground-slider swiper">
                        <div class="swiper-wrapper" id="place-images">
                            <!-- Слайды будут добавлены динамически через JS -->
                        </div>
                        <!-- Кнопки управления -->
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>
                </div>
                <div class="sportground__item">
                  <div class="sportground__title" id="place-title"></div>
                  <div class="sportground__adress">
                    <span class=""></span>
                    <div id="place-address">

                    </div>
                  </div>
                </div>
            </div>
        </div>
       </div>
    </main>

 
{% include "footer.html" %}
<script>
      document.addEventListener("DOMContentLoaded", () => {
        const burger = document.querySelector(".header__burger");
        const menu = document.querySelector(".header__menu");
        const menuClose = document.querySelector(".header__menu-close");
    
        burger.addEventListener("click", () => {
            menu.classList.add("active");
            document.body.style.overflowY = "hidden"
        });
    
        menuClose.addEventListener("click", () => {
            menu.classList.remove("active");
             document.body.style.overflowY = "auto"
        });
    
        // Закрытие меню при клике вне его
        document.addEventListener("click", (e) => {
            if (!menu.contains(e.target) && !burger.contains(e.target)) {
                menu.classList.remove("active");
            }
        });
    });
    
</script>
<script>
    ymaps.ready(init);

    function init() {
        var myMap = new ymaps.Map("map", {
            center: [51.74141771818707, 36.21209148479369], // Центр карты
            zoom: 15
        });

        // Загружаем данные через AJAX
        fetch('/get_sportgrounds_data/')
            .then(response => response.json())
            .then(groundsData => {
                // Добавляем метки для каждой площадки
                groundsData.forEach(function(ground, index) {
                    var placemark = new ymaps.Placemark([ground.latitude, ground.longitude], {
                        balloonContent: ground.name
                    });

                    placemark.events.add('click', function() {
                        selectGround(ground); // Вызываем функцию обновления данных для выбранной площадки
                    });

                    myMap.geoObjects.add(placemark);

                    // Если это первая площадка, обновляем интерфейс
                    if (index === 0) {
                        selectGround(ground); // Устанавливаем данные первой площадки по умолчанию
                        myMap.setCenter([ground.latitude, ground.longitude]); // Центруем карту на первой площадке
                    }
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    // Функция для обновления интерфейса при выборе площадки
    function selectGround(ground) {
        // Обновляем заголовок и адрес
        document.querySelector(".sportground__adress span").textContent = "Адрес: ";
        document.getElementById('place-title').textContent = ground.name;
        document.getElementById('place-address').textContent = ground.address;

        // Очищаем текущие изображения
        var swiperWrapper = document.getElementById('place-images');
        swiperWrapper.innerHTML = '';

        // Добавляем изображения для слайдера
        ground.images.forEach(function(imageUrl) {
            var slide = document.createElement('div');
            slide.classList.add('swiper-slide');
            slide.innerHTML = `<img src="${imageUrl}" alt="Image">`;
            swiperWrapper.appendChild(slide);
        });

        // Обновляем слайдер после добавления новых слайдов
        mainSlider.update();
    }
</script>
<script>
    const mainSlider = new Swiper('.sportground-slider', {
        loop: true, // Зацикливание слайдов
        slidesPerView: 1, 
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev'
        },
        spaceBetween: 10 // Расстояние между слайдами
    });
</script>